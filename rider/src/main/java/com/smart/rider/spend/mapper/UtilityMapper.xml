<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.smart.rider.spend.mapper.UtilityMapper">

	<!-- JoinUtilityDTO resultMap -->
	<resultMap type="com.smart.rider.spend.dto.JoinUtilityDTO" id="joinUtilityMap">
    	<result column="spend_utility_code"     property="spendUtilityCode"/>
    	<result column="contract_shop_code"     property="contractShopCode"/>
    	<result column="subject_code"     		property="subjectCode"/>
    	<result column="spend_utility_pay"     	property="spendUtilityPay"/>
    	<result column="spend_utility_contents" property="spendUtilityContents"/>
    	<result column="spend_utility_date"     property="spendUtilityDate"/>
    	<result column="subject_number"	 		property="subjectNumber"/>
    	<result column="subject_name"     		property="subjectName"/>
    	<result column="shop_code"     			property="shopCode"/>
    	<result column="member_id"         		property="memberId"/>
	</resultMap>
	
	<select id="utilityList" resultMap="joinUtilityMap" parameterType="String">
		SELECT 
			 su.spend_utility_code
			,su.subject_code
			,su.contract_shop_code
			,su.spend_utility_pay
			,su.spend_utility_contents
			,su.spend_utility_date
			,sub.subject_name
		FROM spend_utility su, subject sub
		WHERE su.subject_code = sub.subject_code AND contract_shop_code = #{contractShopCode} 
		ORDER BY su.spend_utility_date DESC
		LIMIT 4;
	</select>
</mapper>