<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.smart.rider.shop.mapper.ShopMapper">

	<select id="shopList" resultType="com.smart.rider.shop.dto.ShopDTO">
		select
			shop_code AS shopCode
			,contract_code AS contractCode
			,member_id AS memberId
			,shop_name AS shopName
			,shop_address AS shopAddress
			,shop_phone AS shopPhone
			,shop_date AS shopDate
		FROM shop
	
	</select>
	
	<select id="getCode" resultType="com.smart.rider.contract.dto.ContractDTO" parameterType="String">
		SELECT 
				member_id AS memberId

		FROM contract
		WHERE contract_code = #{Code};
	
	</select>
	<!-- 계약코드 자동증가 -->

	<select id="shopCodeMax" resultType="String">
		SELECT 
			MAX(LPAD(RIGHT(shop_code, 4)+1, '4' , '0')) 
		FROM shop;
	</select>
	<insert id="shopInsert" parameterType="com.smart.rider.shop.dto.ShopDTO">
			INSERT INTO shop

			(	shop_code
				,contract_code  
				,member_id  
			 	,shop_name
			 	,shop_address
			 	,shop_phone
			 	,shop_date)
		VALUES ( 				
				 #{shopCode}
				,#{contractCode}
				,#{memberId}
			 	,#{shopName}
			 	,#{shopAddress}
		 	  	,#{shopPhone}
		 	    ,NOW()
		 	    )
	
	</insert>
</mapper>

